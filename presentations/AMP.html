<!DOCTYPE html>
<html lang="en"><head>
<script src="AMP_files/libs/clipboard/clipboard.min.js"></script>
<script src="AMP_files/libs/quarto-html/tabby.min.js"></script>
<script src="AMP_files/libs/quarto-html/popper.min.js"></script>
<script src="AMP_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="AMP_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AMP_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="AMP_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="AMP_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Amir Momeni">
  <title>AMP 2024 Course</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="AMP_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="AMP_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="AMP_files/libs/revealjs/dist/theme/quarto.css">
  <link href="AMP_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="AMP_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="AMP_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="AMP_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">AMP 2024 Course</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Amir Momeni 
</div>
</div>
</div>

</section>
<section id="introduction-to-test-validation" class="slide level2">
<h2>Introduction to test validation</h2>
<p>Regulatory bodies such as Clinical Laboratory Improvement Amendments (CLIA), College of American Pathologists (CAP) and some states regulatory bodies (e.g.&nbsp;New York state) require laboratories to validate each new test that they add to their repertoire.</p>
<p>The term ‘Method evaluation’ is used to describe the process of validating a new test. This process requires three elements:</p>
<ul>
<li><p>Test assessment</p></li>
<li><p>Test validation</p></li>
<li><p>Test verification</p></li>
</ul>
<p>We are going to focus on test validation and go over some of the ways R can be useful in the process of test validation.</p>
</section>
<section id="defining-analytical-goals" class="slide level2">
<h2>Defining analytical goals</h2>
<p>The purpose of a test is to diagnose a condition or assess an analyte with acceptable accuracy and precision. The process of validation starts with setting analytical goals also known as setting the ‘<strong>Acceptability Criteria</strong>’.</p>
<p>The acceptability criteria should state clear goals for levels of accuracy and precision. Accuracy and precision goals are defined differently for qualitative and quantitative tests. For quantitative tests, the criteria should also include reportable range and reference intervals.</p>
<p><strong>Required performance characteristics with suggested studies needed before implementation of FDA-approved/cleared tests and laboratory-developed tests</strong></p>
<ul>
<li><p><strong>Reportable Range; linearity study for quantitative assays</strong></p></li>
<li><p><strong>Analytical sensitivity; limit of detection study</strong></p></li>
<li><p><strong>Precision; replication experiment</strong></p></li>
<li><p>Analytical specificity; interference study</p></li>
<li><p><strong>Accuracy; comparison of methods study</strong></p></li>
<li><p><strong>Reference interval</strong></p></li>
</ul>
<h4 id="section"></h4>
<h3 id="acceptability-criteria-for-qualitative-tests">Acceptability criteria for qualitative tests:</h3>
<p>Qualitative tests usually return a binary response (e.g.&nbsp;detected vs.&nbsp;not detected or positive vs.&nbsp;negative), or rarely they can have more than two categorical responses.</p>
<table>
<caption>Contingency Table for Qualitative Tests</caption>
<tbody>
<tr class="odd">
<td></td>
<td>Condition Positive</td>
<td>Condition Negative</td>
</tr>
<tr class="even">
<td>Test Positive</td>
<td>True Positive (TP)</td>
<td>False Positive (FP)</td>
</tr>
<tr class="odd">
<td>Test Negative</td>
<td>False Negative (FN)</td>
<td>True Negative (TN)</td>
</tr>
</tbody>
</table>
<h4 id="common-acceptability-criteria">Common Acceptability Criteria</h4>
<p>1 - Accuracy: How true is the result of the test when compared to the condition status of the test subjects.</p>
<p><span class="math inline">\(Accuracy = TP + TN / TP + TN + FP + FN\)</span></p>
<p>2- Diagnostic Sensitivity: The proportion of the test subjects with the target condition whose test result is positive.</p>
<p><span class="math inline">\(Sen= TP / TP + FN\)</span></p>
<p>3- Diagnostic Specificity: The proportion of individuals without the target condition who test negative</p>
<p><span class="math inline">\(Spe = TN / TN + FP\)</span></p>
<p>Let’s look at some examples:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Sample.Number   NGS_Final.Mutation    PCR_Explore_Final
1    Sample 001              Mutated              Mutated
2    Sample 002 No Mutation Detected No Mutation Detected
3    Sample 003 No Mutation Detected No Mutation Detected
4    Sample 004 No Mutation Detected No Mutation Detected
5    Sample 005 No Mutation Detected No Mutation Detected
6    Sample 006              Mutated              Mutated</code></pre>
</div>
</div>
<p>The data of our test (PCR) and our gold standard (NGS) are presented in two different columns. Lets first change this into a contingency table so that we can have a visual inspection of the accuracy metrics.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                      
                       Mutated No Mutation Detected
  Mutated                  193                    2
  No Mutation Detected      10                  489</code></pre>
</div>
</div>
<p>As you can see our TP number is 193 and our TN number is 489 with small FP and FN numbers. This suggests a high accuracy. Now, let’s calculate the accuracy metrics:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$accuracy
[1] 0.9827089

$sensitivity
[1] 0.9897436

$specificity
[1] 0.9799599</code></pre>
</div>
</div>
<h4 id="visualizing-accuracy-data">Visualizing Accuracy Data</h4>
<p>Another way to inspect the data is to visualize it. We are going to use a very useful library from R called the ‘ggplot’ to achieve this.</p>
<p>The ggplot package in R is a powerful plotting tool. It’s easy to use and allows you to make complex plots with rather simple syntax.</p>
<p>“gg” stands for graphical grammar.</p>
<p>Let’s start by loading the packages (or installing them first if you don’t have them installed already):</p>
<p>Plotting using ‘ggplot’ is based on adding layers. The first layer provides the code for the X and Y coordinates and determines the source of data for these coordinates. This layer is called the ‘aes’ layer.</p>
<p>The next step is to add the type of plot we want to display. We have different options, however, here we want to create a bar plot. To do this, we are going to add a bar plot layer using the “geom_bar” syntax. There are many other “geom” options which can be used based on your data and what you want to display (e.g.&nbsp;geom_point creates a scatterplot).</p>
<p>Remember, we use ‘+’ to connect lines of code in R that need to be run as one code.</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="AMP_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</div>
</div>
<p>We can add layers to the plot to include labels and make it more visually pleasing. Let’s try this again:</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="AMP_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</div>
</div>
<h4 id="measuring-agreement">Measuring Agreement</h4>
<p>We can also measure agreement between the two assays. To this we use a statistics called ‘Cohen’s Kappa’.</p>
<p>Cohen’s kappa is a statistical measure used to evaluate the level of agreement between two raters or two tests that classify items into mutually exclusive categories. It accounts for the possibility of agreement occurring by chance. The kappa value ranges from -1 to 1, where:</p>
<ul>
<li><p>1 indicates perfect agreement,</p></li>
<li><p>0 indicates agreement no better than chance,</p></li>
<li><p>Negative values indicate disagreement.</p></li>
</ul>
<p>Higher kappa values suggest better reliability, with commonly accepted thresholds indicating slight, fair, moderate, substantial, and almost perfect agreement. Kappa is an aggregate measure calculated from observed agreement and expected agreements.</p>
<p><span class="math inline">\(kappa=\frac{P_o - P_e} {1 - P_e}\)</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(P_o\)</span> is the observed proportion of agreement between the two raters.</li>
<li><span class="math inline">\(P_e\)</span> is the expected proportion of agreement by chance, calculated as:</li>
</ul>
<p><span class="math inline">\(P_e= \sum_{i} (P_{A_i} \times P_{B_i})\)</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(P_{A_i}\)</span> is the probability that test A assigns a particular category</li>
<li><span class="math inline">\(P_{b_i}\)</span> is the probability that test B assigns a particular category</li>
</ul>
<p>As you can see it is rather a complex calculation. You can write this formula in R to calculate the Kappa.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9577349</code></pre>
</div>
</div>
<p>This is rather cumbersome, the good news is that for most statistical tests, a package already exists that can help us. For the Kappa agreement, we can use the ‘irr’ package</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    NGS_Final.Mutation    PCR_Explore_Final
1              Mutated              Mutated
2 No Mutation Detected No Mutation Detected
3 No Mutation Detected No Mutation Detected
4 No Mutation Detected No Mutation Detected
5 No Mutation Detected No Mutation Detected
6              Mutated              Mutated</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> Cohen's Kappa for 2 Raters (Weights: unweighted)

 Subjects = 694 
   Raters = 2 
    Kappa = 0.958 

        z = 25.2 
  p-value = 0 </code></pre>
</div>
</div>
<h3 id="setting-cutoffs-for-semiquantitative-tests">Setting cutoffs for semiquantitative tests</h3>
<p>In the laboratory, semi-quantitative tests are also considered as qualitative tests for validation purposes. These semi-quantitative tests measure a quantitative value but report a categorical result based on set cutoffs (e.g.&nbsp;when levels of viral DNA are measured but the result is reported as positive or negative based on a set cutoff).</p>
<p>In these tests, cut-off values must be determined that will set apart the affected from unaffected. Determining cut-off values will depend on:</p>
<ul>
<li><strong>The distribution of the values among unaffected and diseased individuals</strong></li>
<li><strong>The desired sensitivity and specificity levels</strong></li>
</ul>
<p>In a perfect test, the outcome values for the affected and unaffected population will have no overlap. There is, however, always a degree of overlap between the two population making the decision of a cutoff value very important as different cutoff values will lead to different sensitivity and specificity levels.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="ROC-curve-construction-Null-Normal-condition-and-Alternative-Abnormal-condition.jpg"></p>
</figure>
</div>
<h4 id="receiver-operating-characteristic-curve-roc">Receiver operating characteristic curve (ROC)</h4>
<p>Receiver operating characteristic curve (ROC) is the graphical illustration of true positive rate (sensitivity) as the Y-axis and false positive rate (1-specificity) as the X-axis. Consequently, the ROC curve shows the trade-off between sensitivity and specificity.</p>
<p>The basic concept behind the ROC curve is that a test variable (test outcome) is compared with a classifier gold standard and at different cutoff values for the test variable true positive rate and false positive rate are calculated and plotted as Y-axis and X-axis respectively.</p>
<p>ROC space is a square with X- and Y-axis range of 0 to 1. A diagonal line connects the top right corner of the space to the bottom left corner. This line is called the line of no-discrimination and depicts a complete random association of the test variable with the classifier. The perfect classification point in the ROC space (100% specificity and sensitivity) lies at the top left corner of the space.</p>
<p>The further the ROC curve moves away from the diagonal line towards the top left corner the better the classification properties of the test variables will be.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Risk-distributions-and-area-under-the-ROC-curve-AUC-adapted-from-Janssens-Martens-35.png"></p>
</figure>
</div>
<p>Let’s look at an example. In this example, we have digital droplet PCR reads and true infection status of samples.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Sample_Number Biorad_DDPCR GS_Infection_Status
1     Sample001       0.0080            Negative
2     Sample002       0.0080            Negative
3     Sample003       0.0083            Negative
4     Sample004       0.1046            Positive
5     Sample005       0.0090            Negative
6     Sample006       0.0100            Negative</code></pre>
</div>
</div>
<p>Now, let’s create the ROC curve. To do this, we are going to use a package called ‘pROC’.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  Sample_Number Biorad_DDPCR GS_Infection_Status
1     Sample001       0.0080                   0
2     Sample002       0.0080                   0
3     Sample003       0.0083                   0
4     Sample004       0.1046                   1
5     Sample005       0.0090                   0
6     Sample006       0.0100                   0</code></pre>
</div>
<div class="cell-output-display">
<p><img data-src="AMP_files/figure-revealjs/unnamed-chunk-10-1.png" width="960"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.9629</code></pre>
</div>
</div>
<h4 id="determining-cutoffs">Determining cutoffs</h4>
<p>The area under the curve is is 0.9629 which is really good and indicates high accuracy. However, on its own, it does not provide us with the cutoff to set apart positive samples from negative samples.</p>
<p>For determination of the cutoff value, two approaches can be undertaken. In the first approach, a decision must be made on the optimal level of sensitivity and specificity on the ROC curve and the cutoff value extracted from the table of curve coordinates which shows the corresponding test value for each curve coordinate. This manual search for the cutoff value allows for choices such as choosing a cutoff for screening (high sensitivity) or for confirmation (high specificity).</p>
<p>The ‘pROC’ package can provide us this coordinates table.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   threshold sensitivity specificity
1       -Inf  1.00000000  0.00000000
2    0.00310  1.00000000  0.03448276
3    0.00350  1.00000000  0.06896552
4    0.00380  1.00000000  0.10344828
5    0.00445  1.00000000  0.13793103
6    0.00515  1.00000000  0.17241379
7    0.00545  1.00000000  0.20689655
8    0.00580  1.00000000  0.24137931
9    0.00650  1.00000000  0.31034483
10   0.00750  1.00000000  0.48275862
11   0.00815  1.00000000  0.55172414
12   0.00865  1.00000000  0.58620690
13   0.00950  1.00000000  0.65517241
14   0.01005  1.00000000  0.68965517
15   0.01155  0.97435897  0.68965517
16   0.02150  0.97435897  0.72413793
17   0.03300  0.97435897  0.75862069
18   0.04150  0.94871795  0.75862069
19   0.05430  0.92307692  0.75862069
20   0.06880  0.89743590  0.75862069
21   0.08000  0.89743590  0.79310345
22   0.08450  0.89743590  0.82758621
23   0.08925  0.89743590  0.86206897
24   0.09775  0.89743590  0.89655172
25   0.10330  0.87179487  0.89655172
26   0.10680  0.84615385  0.89655172
27   0.11210  0.84615385  0.93103448
28   0.11590  0.82051282  0.93103448
29   0.12980  0.82051282  0.96551724
30   0.14380  0.79487179  0.96551724
31   0.14880  0.76923077  0.96551724
32   0.15600  0.74358974  0.96551724
33   0.17100  0.71794872  0.96551724
34   0.19150  0.71794872  1.00000000
35   0.20440  0.69230769  1.00000000
36   0.22190  0.66666667  1.00000000
37   0.23675  0.64102564  1.00000000
38   0.24325  0.61538462  1.00000000
39   0.27300  0.58974359  1.00000000
40   0.30250  0.56410256  1.00000000
41   0.35515  0.53846154  1.00000000
42   0.40370  0.51282051  1.00000000
43   0.42355  0.48717949  1.00000000
44   0.45390  0.46153846  1.00000000
45   0.47240  0.43589744  1.00000000
46   0.51500  0.41025641  1.00000000
47   0.58900  0.38461538  1.00000000
48   0.62885  0.35897436  1.00000000
49   0.64135  0.33333333  1.00000000
50   0.69505  0.30769231  1.00000000
51   0.81775  0.28205128  1.00000000
52   1.05770  0.25641026  1.00000000
53   1.27950  0.23076923  1.00000000
54   8.19600  0.20512821  1.00000000
55  16.49000  0.17948718  1.00000000
56  23.67500  0.15384615  1.00000000
57  29.63000  0.12820513  1.00000000
58  51.94000  0.10256410  1.00000000
59  79.40500  0.07692308  1.00000000
60 118.28500  0.05128205  1.00000000
61 151.83000  0.02564103  1.00000000
62       Inf  0.00000000  1.00000000</code></pre>
</div>
</div>
<p>Looking at the table, if we want a very sensitive assay for screening then the cutoff can perhaps be set at 0.02150 corresponding to 97.4% sensitivity and 72.4% specificity. If we want a very specific assay then the cutoff can be set at 0.19150 corresponding to 71.79% sensitivity and 100% specificity.</p>
<p>If sensitivity and specificity are given equal weights, then a ROC curve analysis can be employed to determine the optimal cutoff value. Several methods of ROC curve analysis have been established. One of the oldest and simplest methods is called the Youden’s index. This index calculated as the difference of the sum of sensitivity and specificity from 1.</p>
<p><span class="math inline">\(Youden's\ Index =\ (Sen + Spe) - 1\)</span></p>
<p>We can simply calculate this:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  threshold sensitivity specificity     youden
1      -Inf           1  0.00000000 0.00000000
2   0.00310           1  0.03448276 0.03448276
3   0.00350           1  0.06896552 0.06896552
4   0.00380           1  0.10344828 0.10344828
5   0.00445           1  0.13793103 0.13793103
6   0.00515           1  0.17241379 0.17241379</code></pre>
</div>
</div>
<p>and visualize it:</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="AMP_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></p>
</div>
</div>
<p>However, the package has simplified the process and can provide us with this value:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Best cutoff value: 0.09775"</code></pre>
</div>
</div>
<h3 id="measuring-agreement-between-quantitative-assays">Measuring Agreement between Quantitative Assays</h3>
<p>The general approach for method comparison for quantitative tests involves either running 20-40 samples with known values or concurrently running 20-40 samples on the validated test and a gold standard test.</p>
<p>The first steps in evaluating quantitative data is to show it’s summary metrics, such as average, median, and standard deviation.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  qPCR1  qPCR2
1 0.006 0.0037
2 0.006 0.0070
3 0.007 0.0053
4 0.005 0.0083
5 0.007 0.0100
6 0.009 0.0056</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     mean    median range_min range_max        sd 
0.3969895 0.1840000 0.0050000 2.9420000 0.6652805 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean    median range_min range_max        sd 
0.4036605 0.1773000 0.0029000 2.9840000 0.6787962 </code></pre>
</div>
</div>
<p>It can also help if we visualize the data. For example, let’s do a boxplot.</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="AMP_files/figure-revealjs/unnamed-chunk-17-1.png" width="960"></p>
</div>
</div>
<h4 id="linear-correlation-test">Linear Correlation Test</h4>
<p>The results are then compared by running a linear correlation test. These results can also be inspected visually using a comparison plot which is essentially a linear correlation plot.</p>
<p>If the results have high linearity with a one to one agreement, then an alternative approach is to use a ‘difference plot’ which shows the difference of the test versus the comparison on the Y-axis and the results of comparative method on the X-axis. The difference points should scatter around 0 on the Y-axis.</p>
<p>Let’s look at an example.</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="AMP_files/figure-revealjs/unnamed-chunk-18-1.png" width="960"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pearson's correlation coefficient: 0.999"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qPCR2 ~ qPCR1, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.079557 -0.013277 -0.002429  0.007375  0.093721 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.0009747  0.0059355  -0.164     0.87    
qPCR1        1.0192593  0.0077368 131.742   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03131 on 36 degrees of freedom
Multiple R-squared:  0.9979,    Adjusted R-squared:  0.9979 
F-statistic: 1.736e+04 on 1 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output-display">
<p><img data-src="AMP_files/figure-revealjs/unnamed-chunk-18-2.png" width="960"></p>
</div>
</div>
<p>Running a linear correlation on the results will also provide you with the standard deviation of the points around the fitted line, the confidence interval of the slope, the ‘correlation coefficient’ (also known as ‘Pearson’s r coefficient’) as well as a p-value.</p>
<p>A significant p-value is needed to say that there is linear correlation. In other words, a significant p-value is the first thing you should look at in the method comparison experiment which will tell you if the new test is useful for measuring the target analyte. Thus, a significant p-value is what you need for validation.</p>
<p>The next step is to look at the correlation coefficient to determine if there is any systematic error. <strong>Pearson’s r coefficient</strong> shows how well the compared results change together and can have values of between -1 and 1. The closer the value is to 1, the higher the correlation.</p>
<p>The <strong>R-squared</strong> value is a measure of how well the <strong>regression line fits the data</strong>. It represents the proportion of the variance in the dependent variable that is explained by the independent variable.</p>
<h4 id="t-test-for-method-comparison-experiments">t-test for method comparison experiments</h4>
<p>The t-test should be run to determine if the mean of the two sets of results is the same or in other words t-test can determine if there is any systematic error (bias) in the mean of the two sets of values. In most method comparison experiments it is best to use a paired t-test, since the same sample is being compared using two different methods (and thus a degree of similarity of the means expected and running an unpaired t-test will fail to detect the bias). If the t-test returns a non-significant value, then there is no systematic error.</p>
<p>If the t-test returns a significant p-value, then it shows that there is a significant bias (systematic error) in the mean of the two sets of values. If the t-test is significant, then you should go back to the linear regression equation to determine whether the source of the bias is the constant or the slope. Constant error is easily remedied by adding the constant to the new test results. However, for proportional errors ‘recovery experiments’ are needed.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  data$qPCR1 and data$qPCR2
t = -1.2299, df = 37, p-value = 0.2265
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.01766097  0.00431886
sample estimates:
mean difference 
   -0.006671053 </code></pre>
</div>
</div>
<p>As you can see, the t-test returned a significant p-value indicating that the two measurements’ average are not the same. This indicates a systemic bias is not present.</p>
<h4 id="f-test-for-precision">F-test for precision:</h4>
<p>‘F-test’ or analysis of variance compares the variance of the test method with the comparative method. In simple terms, F-test shows whether the variation observed in the test values is different from the variations observed for the comparative value. If no random error exists, you would expect the variations of the two sets of result to be similar i.e.&nbsp;any variation observed in the test result is caused by actual variation of the sample value rather than due to error. F-test for two variances is a simpler form of the ANOVA equation.</p>
<p>If the p-value shows no significance then we can state that the random error in the test is not more than the random error of the comparison method, conversely, a significant p-value signifies the existence of significant random error in addition to the random error of the comparison method.</p>
<p>An advantage of running the linear regression model in r is that it automatically calculate the F-test.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qPCR2 ~ qPCR1, data = data)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.079557 -0.013277 -0.002429  0.007375  0.093721 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.0009747  0.0059355  -0.164     0.87    
qPCR1        1.0192593  0.0077368 131.742   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.03131 on 36 degrees of freedom
Multiple R-squared:  0.9979,    Adjusted R-squared:  0.9979 
F-statistic: 1.736e+04 on 1 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="exercises" class="slide level2">
<h2>Exercises:</h2>
<h3 id="exercise-1">Exercise 1:</h3>
<p>Calculate accuracy, and create a bar plot.</p>
<p>Load the data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                Test_X        Gold_Standard
1              Mutated              Mutated
2 No Mutation Detected No Mutation Detected
3 No Mutation Detected No Mutation Detected
4 No Mutation Detected No Mutation Detected
5 No Mutation Detected No Mutation Detected
6              Mutated              Mutated</code></pre>
</div>
</div>
<p>Now, create the contingency table.</p>
<p>Next, let’s calculate the parameters</p>
<p>Now, we can end by visualizing our data.</p>
<h3 id="exercise-2">Exercise 2:</h3>
<p>Create an ROC curve, find the best cutoff using Youden’s index.</p>
<p>Load the data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      Test_Y Status
1 0.02340413      0
2 0.02665255      0
3 0.03053173      0
4 0.04748700      0
5 0.06260755      0
6 0.08139692      0</code></pre>
</div>
</div>
<p>Create the ROC curve plot. Calculate area under the curve.</p>
<p>Calculate the bestcutoff.</p>
<h3 id="exercise-3">Exercise 3:</h3>
<p>Do linear regression.</p>
<p>Load the data:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>      Test1     Test2
1 0.1214406 0.1273602
2 0.2078658 0.2144313
3 0.3934922 0.4572305
4 0.8689299 0.9082452
5 0.8690936 0.9063212
6 0.9663189 0.9417779</code></pre>
</div>
</div>
<p>Do Pearson’s correlation and fit a linear model:</p>
<p>Plot the linear correlation:</p>
</section>
<section id="total-allowable-error" class="slide level2">
<h2>Total allowable error</h2>
<p>‘Total error’ or ‘total analytical error’(TAE) is the sum of systematic error and random error. It has been shown that total error is a more accurate measure of diagnostic error than bias (systematic error) alone. The systematic error will be calculated from a method comparison study and the random error is calculated from a replication study (which can be a part of the method comparison study). Total analytical error is then defined as:</p>
<p><span class="math inline">\(TAE= bias +2SD\)</span> for two-tailed estimates</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Bias: 0.007"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Standard Deviation of Difference: 0.033"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Total Allowable Error (TAE): 0.074"</code></pre>
</div>
</div>
<p>Simply stated, the measured value can be different from the true value not only by the amount of systematic error but also by random error (random error can alleviate or aggravate the bias)</p>
</section>
<section id="sample-size-calculation-for-qualitative-tests" class="slide level2">
<h2>Sample Size Calculation for Qualitative Tests</h2>
<p>For a qualitative test, the goal is to determine a sample size that will provide sufficient power to determine sensitivity and specificity to the desired level of confidence for the particular application.</p>
<p>There are several approaches that can be used for sample size calculations.</p>
<p>One formula that can be used for both quantitative and qualitative tests is based on set levels of confidence and reliability. Confidence (accuracy) is the difference between 1 and type I error rate. Reliability is the degree of precision. For this formula, the failure rate must be decided as well: i.e.&nbsp;how many incorrect results are we allowing for our validation process. For a failure rate of 0, the equation can be stated as:</p>
<p><span class="math inline">\(n= \frac{ln(1 - confidence)}{ln(reliability)}\)</span></p>
<p>Usually the confidence level is set at 0.95 and reliability at 0.90 or 0.80 with zero failure rate which translates to a sample size of 29 and 14 respectively.</p>
<p>For failure rates other than 0, the results follow a binomial distribution. The calculation of the sample size is based on the following equation:</p>
<p><span class="math inline">\(1-confidence=\sum^f_i(^n_i)\times(1-reliability)^i\times reliability^{n-i}\)</span></p>
<p>Where <span class="math inline">\(f\)</span> is the failure rate and <span class="math inline">\(n\)</span> is the sample size.</p>
<p>While this may sound daunting. We can easily do the calculation in R.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Required sample size: 77"</code></pre>
</div>
</div>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="AMP_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="AMP_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="AMP_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="AMP_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="AMP_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="AMP_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="AMP_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="AMP_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="AMP_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="AMP_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>